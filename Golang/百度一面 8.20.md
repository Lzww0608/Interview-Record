# 百度一面 8.20

## 1. 自我介绍



## 2. 技能广度

说明自己掌握多门语言，比如C/C++，Go等。



### 3.  Go逃逸分析

简单来说，逃逸分析用于确定一个变量的内存分配位置，它会分析变量的作用域和生命周期，来决定是在栈上分配内存还是堆上分配内存。通过`go build -gcflags="-m"`命令查看编译器逃逸分析的结果。

发生逃逸的情况：

+ 变量的作用域超出了其所在的函数：比如一个函数返回了一个局部变量的指针，由于函数返回后该局部变量仍然需要被访问，所以它不能分配在栈上，而要分配在堆上。

```go
func createrPointer() *int {
    num := 5
    return &num
}
```

+ 切片或者映射等动态大小的数据结构的时候，当切片或映射分配内存时，如果其大小在编译期无法确定，变量则逃逸到堆上。

```go
func createSlice() []int {
    return []int{1, 2, 3}
}
```

+ 如果一个变量被全局变量引用，则它会发生逃逸。



## 4. Gin的http方法是如何实现的？

+ 路由注册：使用特定的方法来注册不同的路由路径对应的处理函数。
+ 上下文对象(gin.Context)：在处理函数中，通过`gin.Context`对象获取请求的相关信息，如请求参数、头部信息等，并设置相应的状态码、数据等。
+ 中间件支持：可以在路由器处理之前或之后添加中间件来执行一些通用的逻辑，如日志记录、权限校验等。
+ 分组路由：可以将相关的路由分组。
+ 相应处理：设置响应的状态码，返回数据的格式（JSON, HTML）



## 5. Gin框架的标签机制

+ JSON标签：用于将结构体字段与JSON数据进行绑定。
+ URL标签：用于从URL路径中提取参数。
+ BINDING标签：用于指定参数的验证规则。
+ FORM标签：用于将表单字段与结构体字段进行绑定。



## 6. Channel了解吗？

+ 内部结构
  + `channel`在内部由一个**环形缓冲区**和**两个等待队列**组成。
  + 环形缓冲区用于存储发送的数据，当缓冲区慢时，发送会阻塞；同理缓冲区为空时，接受会阻塞。
  + 两个等待队列分别用于存储因发送或者接收操作而阻塞的`goroutine`。当相应条件满足时，这些`goroutine`会被唤醒并继续执行。
+ 使用场景
  + 数据传递与共享
  + 任务分发与协调
  + 控制并发数量
  + 实现信号通知

**通过通信来共享内存，而非通过共享内存来通信**



## 7. Sync包有哪些东西

+ Mutex： 用于保证在同一时刻只有一个`goroutine`可以访问共享资源，防止数据竞争。
+ RWMutex： 提供了更细粒度的控制，允许多个`goroutine`同时读取共享资源，但在写操作时进行排他锁定。
+ Sync.Map：支持**并发安全**的Map数据结构。
+ Sync.Once：确保每个操作只执行一次，用于初始化只执行一次的共享资源。
+ Sync.Pool：对象池，用于复用临时对象，减少内存分配和垃圾回收的开销。



## 8. HTTP状态码

+ 1XX 信息性状态码
+ 2XX 成功状态码
+ 3XX 重定向状态码
+ 4XX 客户端错误状态码
  + 499： Nginx自定义状态，表示客户端在请求还没有完成的时候关闭了连接。
+ 5XX 服务器错误状态码



## 9. Redis应用与数据一致性

+ 可能会导致不一致的情况
  + **并发操作**：多个客户端对`Redis`中的数据进行读写操作。
  + **数据过期**：设置了过期时间的键，在过期时间到达之前没有更新或处理。
  + **主从复制延迟**：在`Redis`主从架构中，主节点的数据变更需要同步到从节点，如果同步过程存在延迟，可能导致从节点读取到的数据与主节点不一致。
+ 解决方法
  + **事务**：使用一个原子操作，但`Redis`不支持回滚。
  + **乐观锁**：使用`WATCH`命令实现乐观锁机制。
  + **Lua脚本**：多个操作可以使用Lua脚本完成事务。



## 10. MySQL innodb引擎为什么逐渐推荐自增

+ **优化B+树结构**：`InnoDB`使用B+树来组织结构，自增逐渐可以使得B+树的结构更加紧凑，减少树的深度，提高增删改查的效率。
+ **减少页分裂**：`InnoDB`以页为单位存储数据，如果主键不是自增的，插入新数据的时候可能导致页的频繁分裂和重组。
+ **提高存储和查找的性能**：自增主键在插入时锁的粒度更小，数据分布更有序。



## 11. MySQL删除操作的时候容量会不会变？

不会，删除操作只是在数据行上做了删除标记，而不是真正从物理上删除数据和释放磁盘空间。要真正减少表的物理存储空间，需要执行 `OPTIMIZE TABLE` 命令或重建表。这些操作会重新组织表中的数据，并释放未使用的空间，进而减少表的物理大小。



## 12. 微服务架构利弊

+ 优点
  + 独立部署和扩展
  + 灵活的技术选型
  + 容错率高
  + 指责明确
  + 敏捷开发
+ 缺点
  + 分布式事务处理困难
  + 测试复杂性
  + 业务排查问题慢
  + 数据一致性