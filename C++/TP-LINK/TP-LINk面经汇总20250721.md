# TP-LINk面经汇总20250721

## 讲一下CPU处理中断的过程

| 阶段  | 阶段名称                              | 主要参与者                      | 核心任务                                                     | 关键机制/数据结构                                            | CEO工作类比                                                  |
| ----- | ------------------------------------- | ------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **1** | **中断请求与识别**                    | **硬件** (外设, 中断控制器APIC) | 外部设备或CPU内部事件产生信号；中断控制器对信号进行优先级排序，并发送中断请求给某个CPU核心。 | I/O设备、APIC/IOAPIC、中断线(IRQ)                            | 秘书/助理敲响CEO办公室的门，告知有紧急事务。                 |
| **2** | **CPU响应与上下文切换**               | **硬件** (CPU)                  | 在执行完当前指令后，CPU检测到中断信号，暂停当前程序。**硬件自动**完成从用户态到内核态的切换，并保存关键的执行上下文（断点）。 | IF标志位、**内核栈**、SS/RSP/RFLAGS/CS/RIP寄存器压栈、特权级从Ring 3切换到Ring 0。 | CEO停下手头的工作，记下自己刚才在想什么（保存断点），然后站起来准备去接电话。 |
| **3** | **查找中断服务程序(ISR)**             | **硬件(CPU) + OS内核**          | CPU使用硬件提供的**中断向量号**，在内核预设的表中查找对应的处理程序入口地址。 | **IDTR寄存器** 指向 **IDT (中断描述符表)**，CPU以中断向量号为索引在IDT中定位门描述符，获取ISR地址。 | CEO通过来电显示（中断向量号）识别是谁打来的电话，从而决定该用什么态度和方式来沟通（查找处理程序）。 |
| **4** | **执行中断上半部(Top Half)**          | **OS内核** (汇编入口+C函数)     | 执行通用中断入口代码，保存所有通用寄存器。然后调用与该中断向量号关联的、由驱动程序注册的ISR。**此阶段必须极快完成**，只处理最紧急的任务（如：从硬件读数据、应答硬件）。 | 汇编入口(stub)、pushaq、do_IRQ()分发函数、设备驱动的handler函数。此阶段通常会屏蔽中断。 | CEO拿起电话，快速说出最关键的指令：“收到，数据我拿到了，你先别急。”（与硬件交互），然后告诉秘书后续处理。 |
| **5** | **调度并执行中断下半部(Bottom Half)** | **OS内核** (调度器)             | ISR（上半部）将耗时较长的任务（如数据包处理、通知用户空间）注册为“下半部”任务，然后快速返回。内核会在稍后（中断恢复后）的安全时刻调度执行这些任务。 | **Softirq、Tasklet、Workqueue**。此阶段在中断开启的情况下执行，不阻塞新的中断。 | 秘书（下半部机制）根据CEO的简短指令，开始整理详细报告、分发任务、通知相关部门等耗时较长的工作。 |
| **6** | **中断返回**                          | **OS内核 + 硬件(CPU)**          | 中断处理（主要是上半部）完成后，执行恢复操作。恢复所有通用寄存器，最后通过特殊指令，让**硬件自动**恢复之前保存的上下文，并将特权级切回用户态。 | popaq、iret (Interrupt Return)指令。iret指令原子性地恢复RIP/CS/RFLAGS/RSP/SS，特权级从Ring 0切回Ring 3。 | CEO挂断电话，坐回办公桌，看着刚才记下的笔记（恢复断点），无缝衔接地继续之前的工作。 |



## linux中查询进程占用的命令
+ 按内存占用降序排序
  `ps aux --sort=-%mem | head -n 10`

+ 按CPU占用降序排序
  `ps aux --sort=-%cpu | head -n 10`

+ 查看某个进程打开了哪些文件
  `lsof -p <PID>`

+ 查看哪个进程占用了8080端口
  `lsof -i :8080`



## mac地址



## get和post区别





## 智力题：1000瓶酒，有一瓶有毒，最少用多少只老鼠可以最快检验出有毒的酒的编号（经典二进制问题）





## 数据链路层作用

