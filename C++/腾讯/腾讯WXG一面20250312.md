# 腾讯WXG一面20250312

腾讯wxg 一面 3.6



## 手撕:实现一个简易的令牌桶算法

- **头文件:** 包含了必要的头文件 `<iostream>`, `<chrono>`, `<mutex>`, `<algorithm>`, `<thread>`.
- **TokenBucket 类:** 如前面所述，包含了容量、生成速率、当前令牌数、上次补充时间以及互斥锁等成员变量。
- **refill() 方法:** 根据时间流逝补充令牌，并限制令牌数量不超过容量。
- **try_consume() 方法:** 尝试消费令牌，先补充令牌，然后判断令牌是否足够，并进行消费或拒绝。使用了 `std::lock_guard` 进行自动加锁解锁，保证线程安全。
- **get_tokens() 方法:** 用于获取当前令牌数，也使用了 `std::lock_guard` 保证线程安全读取。
- **main() 函数:** 创建了一个令牌桶实例，并模拟了 15 次请求。每次请求尝试消费不同数量的令牌，并打印请求是否被允许以及剩余令牌数。使用 `std::this_thread::sleep_for` 模拟请求的间隔时间，以便观察令牌桶的填充效果。



## 结合刚才实现的算法，说说和其他限流算法相比的优势在哪里

漏桶算法、滑动窗口计数器

1. 实现简单
2. 允许突发流量



项目中的本地缓存和项目是一个进程还是两个进程?



## 如果这个缓存想为多个进程服务，用哪种通信方式比较好

共享内存、消息队列、rpc



如果是在同一个进程中，说说这样设计的好处是什么

为啥这个不使用共享内存呢？



## 慢查询优化

**发现慢查询：**  首先要找到哪些查询是慢查询。  常用的方法是**开启 MySQL 的慢查询日志 (Slow Query Log)**，将执行时间超过阈值的 SQL 语句记录下来。  还可以使用 **MySQL Performance Schema** 或第三方监控工具来更全面地监控和分析查询性能

**分析慢查询：**  拿到慢查询 SQL 后，需要分析**为什么慢**。  最核心的工具是 **EXPLAIN 语句**。  `EXPLAIN` 可以模拟 MySQL 的查询优化器执行 SQL 的过程，并输出详细的执行计划

**优化慢查询：**  根据分析结果，采取相应的优化策略。  常见的优化方法包括：

+ **索引优化 (Index Optimization)：**  **这是最重要、最有效的优化手段之一。**
+ **SQL 语句优化 (SQL Query Optimization)：**
+ **MySQL 配置优化 (MySQL Configuration Tuning)**



## 索引类型

**1.  从数据结构角度分类 (这是最常见的分类方式)：**

- **B-Tree 索引 (B-Tree Index)：**  这是 **MySQL 中最常见、也是默认的索引类型**，尤其是在 **InnoDB 和 MyISAM 存储引擎中**。  实际上，更准确的说是 **B+Tree 索引**。
- **Hash 索引 (Hash Index)：**  Hash 索引基于哈希表实现。  **只有 Memory 存储引擎显式支持 Hash 索引**，InnoDB 引擎的自适应哈希索引 (Adaptive Hash Index) 是一种内部优化，用户无法直接控制。
- **Fulltext 索引 (Fulltext Index)：**  全文索引用于 **对文本内容进行全文搜索**，例如文章内容、新闻报道等。  **MyISAM 和 InnoDB 存储引擎都支持 Fulltext 索引 (InnoDB 从 MySQL 5.6.4 版本开始支持)。**
- **Spatial 索引 (Spatial Index)：**  空间索引用于 **存储和查询空间数据**，例如地理坐标、几何图形等。  **MyISAM 和 InnoDB 存储引擎都支持 Spatial 索引 (但 InnoDB 的支持相对有限)。**

**2.  从物理存储角度分类 (针对 InnoDB 存储引擎)：**

- **聚簇索引 (Clustered Index)：**  **InnoDB 中，表数据文件本身就是按照 B+Tree 组织的一个索引结构。  这个索引的叶子节点包含了完整的数据行记录。  这种索引就是聚簇索引。**
- **二级索引 (Secondary Index) / 辅助索引 (Non-clustered Index)：**  **除了聚簇索引之外的所有索引都属于二级索引。**

**3.  从逻辑角度分类：**

- **普通索引 (Index)：** 最基本的索引类型，没有唯一性限制，允许索引列的值重复和为 NULL。
- **唯一索引 (Unique Index)：** 索引列的值必须唯一，但允许有 NULL 值 (除非显式指定 `NOT NULL`)。 唯一索引可以保证数据唯一性，同时也具有索引的查询加速功能。
- **主键索引 (Primary Key Index)：** 一种特殊的唯一索引，**每张表只能有一个主键索引**。 主键索引列的值必须唯一且不允许为 NULL。 主键索引通常在创建表时指定，用于唯一标识表中的每一行记录。 **InnoDB 中，主键索引也是聚簇索引。**
- **复合索引 (Composite Index / Multiple-Column Index)：** 也称为联合索引，指 **由多个列组合而成的索引**。 复合索引遵循 **最左前缀原则**，查询时需要从复合索引的最左边列开始匹配才能有效利用索引。



说说你知道的除了redis之外的非关系型数据库

## 对于关系型数据库，为啥mysql存在那么多问题大部分公司还是选用的这个

1. 开源免费，成本低
2. 社区生态成熟
3. 性能出色
4. 易学易用



家在哪里

是否接受深圳工作

